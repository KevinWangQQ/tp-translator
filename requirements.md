# Figma 翻译插件需求文档

## 版本信息
- **文档版本**: v1.0
- **创建日期**: 2025-08-15
- **最后更新**: 2025-08-15
- **项目阶段**: 需求分析

## 1. 项目概述

### 1.1 项目背景
基于对 Cube Translator 插件的深入分析，开发一个功能完整、技术先进的 Figma 翻译插件。该插件将完全复刻 Cube Translator 的核心功能，并在此基础上扩展支持 Google Gemini 模型，为用户提供更多的 AI 翻译引擎选择。

### 1.2 项目目标
- 完全复刻 Cube Translator 的用户界面和交互体验
- 支持多 AI 翻译引擎（OpenAI + Gemini）
- 实现智能字体映射和样式保持
- 提供翻译记忆和术语管理功能
- 优化翻译质量和用户体验

### 1.3 目标用户
- 需要多语言设计的 UI/UX 设计师
- 从事出海产品设计的团队
- 需要快速验证多语言界面的产品经理
- 国际化设计项目的设计团队

## 2. 功能需求

### 2.1 核心翻译功能

#### 2.1.1 文本选择和识别
- **FR-001**: 支持单个文本图层选择翻译
- **FR-002**: 支持多个文本图层批量选择翻译
- **FR-003**: 支持整个框架(Frame)内所有文本翻译
- **FR-004**: 自动识别选中区域内的所有文本节点
- **FR-005**: 过滤非文本元素，仅处理文本图层

#### 2.1.2 语言支持
- **FR-006**: 支持 130+ 种语言的互译
- **FR-007**: 智能源语言识别
- **FR-008**: 提供常用语言快速选择
- **FR-009**: 支持语言代码显示
- **FR-010**: 记住用户最常用的语言对

#### 2.1.3 翻译结果输出模式
- **FR-011**: 替换原文本模式 (Replace source text)
- **FR-012**: 在原文本旁边显示翻译 (Display on beside)
- **FR-013**: 在新框架中显示翻译 (Display on new Frame)
- **FR-014**: 在新页面中显示翻译 (Display on new page)

### 2.2 AI 翻译引擎支持

#### 2.2.1 OpenAI 引擎
- **FR-015**: 支持 GPT-3.5-turbo-instruct 模型
- **FR-016**: 支持 GPT-4 系列模型
- **FR-017**: 可配置 OpenAI API 密钥
- **FR-018**: 支持自定义翻译提示词

#### 2.2.2 Gemini 引擎 (新增功能)
- **FR-019**: 支持 gemini-pro 模型
- **FR-020**: 支持 gemini-1.5-pro 模型
- **FR-021**: 支持 gemini-1.5-flash 模型
- **FR-022**: 可配置 Gemini API 密钥
- **FR-023**: 支持模型切换和对比

#### 2.2.3 引擎管理
- **FR-024**: 翻译引擎选择器（OpenAI/Gemini）
- **FR-025**: 模型选择器（根据引擎动态更新）
- **FR-026**: API 密钥安全存储
- **FR-027**: 翻译成本预估显示

### 2.3 字体映射系统

#### 2.3.1 字体识别和映射
- **FR-028**: 自动识别源文本的字体族和字重
- **FR-029**: 支持不同字重的独立字体映射
- **FR-030**: 字体映射规则的保存和复用
- **FR-031**: 常用字体映射模板

#### 2.3.2 字体映射界面
- **FR-032**: Source Font / Target Font 双列显示
- **FR-033**: 支持 Regular, Medium, Bold, Semi Bold 等字重
- **FR-034**: 字体选择下拉菜单
- **FR-035**: 字体预览功能

### 2.4 样式保持功能

#### 2.4.1 文本样式保持
- **FR-036**: 保持原文本的字号大小
- **FR-037**: 保持原文本的颜色和透明度
- **FR-038**: 保持原文本的对齐方式
- **FR-039**: 保持原文本的行高和字间距
- **FR-040**: 保持原文本的装饰效果（下划线、删除线等）

#### 2.4.2 布局适应
- **FR-041**: 自动调整文本框尺寸适应翻译内容
- **FR-042**: 保持文本在容器中的相对位置
- **FR-043**: 处理文本溢出的情况
- **FR-044**: 多行文本的智能换行处理

### 2.5 翻译记忆功能

#### 2.5.1 翻译历史
- **FR-045**: 保存翻译历史记录
- **FR-046**: 翻译历史的搜索和过滤
- **FR-047**: 重复翻译的自动应用
- **FR-048**: 翻译历史的导出功能

#### 2.5.2 术语管理
- **FR-049**: 自定义术语词典
- **FR-050**: 术语的批量导入和导出
- **FR-051**: 术语一致性检查
- **FR-052**: 行业术语库支持

### 2.6 用户界面功能

#### 2.6.1 主界面
- **FR-053**: 插件 Logo 和品牌展示
- **FR-054**: Home / Translate 导航切换
- **FR-055**: 设置按钮快速访问
- **FR-056**: 状态提示和进度显示

#### 2.6.2 设置界面
- **FR-057**: Common / Translation Memories 标签页
- **FR-058**: 翻译引擎和模型选择
- **FR-059**: 默认目标语言设置
- **FR-060**: 保存/取消操作确认

## 3. 非功能需求

### 3.1 性能需求
- **NFR-001**: 单个文本翻译响应时间 < 3秒
- **NFR-002**: 批量翻译处理速度 > 10个文本/分钟
- **NFR-003**: 插件启动时间 < 2秒
- **NFR-004**: 内存占用 < 50MB

### 3.2 可用性需求
- **NFR-005**: 界面操作流程 ≤ 3步完成翻译
- **NFR-006**: 支持键盘快捷键操作
- **NFR-007**: 提供操作提示和帮助信息
- **NFR-008**: 错误信息清晰易懂

### 3.3 可靠性需求
- **NFR-009**: 网络异常时的重试机制
- **NFR-010**: API 调用失败的降级处理
- **NFR-011**: 数据本地备份和恢复
- **NFR-012**: 插件崩溃恢复机制

### 3.4 安全性需求
- **NFR-013**: API 密钥本地加密存储
- **NFR-014**: 翻译内容不在本地永久保存
- **NFR-015**: 用户数据隐私保护
- **NFR-016**: 第三方 API 的安全调用

## 4. 技术约束

### 4.1 平台约束
- 必须基于 Figma Plugin API 开发
- 支持 Figma 桌面版和网页版
- 兼容最新版本的 Figma

### 4.2 技术栈约束
- 前端：React + TypeScript
- 构建工具：Webpack
- API 集成：OpenAI API + Gemini API

### 4.3 第三方依赖
- OpenAI API 服务稳定性
- Google Gemini API 可用性
- Figma Plugin API 更新兼容性

## 5. 验收标准

### 5.1 功能验收
- 所有功能需求点 100% 实现
- 界面与 Cube Translator 像素级一致
- 翻译质量达到商业化标准

### 5.2 性能验收
- 响应时间达到性能需求指标
- 并发处理能力满足用户需求
- 资源占用在合理范围内

### 5.3 用户验收
- 用户操作流程简洁直观
- 翻译结果准确可靠
- 异常情况处理得当

## 6. 风险和假设

### 6.1 技术风险
- 第三方 API 服务中断或限流
- Figma Plugin API 变更影响功能
- 字体映射的复杂性超出预期

### 6.2 业务风险
- 翻译成本控制
- 用户接受度和市场竞争
- 版权和合规问题

### 6.3 假设条件
- 用户具备基本的 Figma 使用技能
- 用户能够获取和配置 AI API 密钥
- 网络环境支持 API 调用

## 7. 未来扩展

### 7.1 短期扩展 (3-6个月)
- 支持更多 AI 翻译引擎
- 增加翻译质量评分功能
- 团队协作和分享功能

### 7.2 长期规划 (6-12个月)
- 多模态翻译（图像中的文字）
- 设计规范自动适配
- 云端翻译记忆同步

---

**文档维护说明**：
本需求文档将在项目开发过程中持续更新，每次需求变更都会记录版本历史和变更原因。所有开发人员都应该基于最新版本的需求文档进行开发工作。