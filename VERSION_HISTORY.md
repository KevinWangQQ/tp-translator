# TP Translator 版本迭代记录

> 本文档记录项目的版本规划、开发进度和迭代历史

## 📊 版本状态概览

| 版本 | 状态 | 发布日期 | 类型 | 描述 |
|------|------|----------|------|------|
| v1.2.0 | ✅ Released | 2024-09-03 | Stable | 完整功能稳定版本 |
| v1.2.1 | ✅ Released | 2025-09-05 | Patch | 用户体验增强版 - 定位、编辑、回退功能 |
| v1.2.2 | 🚀 In Planning | 2025-09-06 | Patch | 翻译精准度提升版 - Settings重构、Prompt定制、专业词库 |
| v1.3.0 | 📅 Planned | 2024-10-01 | MINOR | 撤销和批量编辑功能增强版 |
## 🎯 版本规划路线图

### 当前稳定版本
- **v1.2.0**: 完整功能的稳定版本，推荐生产使用

### 计划版本
- **v1.2.1**: 用户体验优化，增强交互功能 (2024-09-10)
- **v1.3.0**: 计划加入撤销功能和批量编辑 (TBD)
- **v2.0.0**: 重大架构升级 (未来规划)

---

## 📝 详细版本记录

### v1.2.0 - 稳定基础版本
**发布日期**: 2024-09-03  
**版本类型**: Stable Release  
**开发状态**: ✅ 已完成  

#### 📋 版本概述
这个版本已成功发布，包含计划的所有功能。
这是项目的第一个标准化稳定版本，包含了完整的Figma翻译功能。

#### ✨ 主要功能
- **双引擎支持**: OpenAI (GPT-3.5, GPT-4) 和 Google Gemini
- **智能词库匹配**: 自定义术语翻译和智能匹配
- **多种输出模式**: 替换、并排显示、新框架、新页面
- **字体映射系统**: 自动字体适配和管理
- **内容过滤**: SF Symbols检测和智能跳过
- **翻译记忆**: 历史翻译管理和复用
- **提示词系统**: 自定义翻译上下文和约束
- **批量处理**: 高效的多节点翻译

#### 🛠️ 技术特性
- Figma Plugin API 完整集成
- 双线程架构 (主线程 + UI线程)  
- 类型安全的消息通信
- 模块化代码组织
- 智能批量处理和缓存

#### 📦 发布信息
- **包大小**: 26KB
- **文件位置**: `releases/v1.2.0/tp-translator-v1.2.0.zip`
- **GitHub Release**: [v1.2.0-release-restructure](https://github.com/KevinWangQQ/tp-translator/releases/tag/v1.2.0-release-restructure)

#### 🎯 使用建议
- 适合生产环境使用
- 推荐配合Gemini Pro引擎使用（成本效益最佳）
- 建议启用词库功能提高翻译一致性

#### 📊 开发统计
- **开发周期**: 3个月
- **主要提交**: 3个重大提交  
- **文件数量**: 4个核心文件
- **测试状态**: 手动测试通过

#### 🔄 升级路径
- 从旧版本升级: 直接替换文件即可
- 配置兼容: 需重新配置API密钥

---

## 🚀 未来版本规划

### v1.2.1 - 用户体验增强版 (已完成)
**发布日期**: 2025-09-05  
**版本类型**: Patch Release (UX Enhancements)  
**开发状态**: ✅ 已完成并发布  

#### 🎯 版本目标
这是一个用户体验优化版本，重点提升翻译结果页面的交互功能和用户操作便利性。

#### ✨ 已实现功能
- ✅ **快速定位功能**: 每个翻译结果都有定位按钮，可快速在Figma中找到对应组件
- ✅ **一键回退功能**: 支持一键撤销所有已应用的翻译，安全确认机制
- ✅ **实时编辑翻译**: 直接在结果页面编辑翻译内容，失焦自动保存并同步到Figma
- ✅ **默认引擎优化**: 默认启用Gemini 1.5 Flash引擎，开箱即用
- ✅ **智能文本统计**: 实时显示已选择的文本节点数量，自动响应选择变化
- ✅ **批量修改功能**: 智能检测相同文本，支持批量修改并同步到Figma

#### 🛠️ 技术实现
- 新增消息处理器：`rollback-all-translations`、`update-translation`
- 跨浏览器复制功能：Clipboard API + execCommand备用方案
- 智能状态管理：精确追踪翻译的应用/回退状态
- 批量同步机制：智能检测已应用翻译并批量更新到Figma

#### 🐛 修复问题
- 修复回退功能实现问题
- 修复复制功能兼容性问题  
- 修复手动编辑后不同步到Figma的问题
- 修复批量修改时只更新当前项的同步bug

#### 📦 发布信息
- **包大小**: 30KB
- **文件位置**: `releases/v1.2.1/tp-translator-v1.2.1.zip`
- **完整文档**: `releases/v1.2.1/RELEASE_NOTES_v1.2.1.md`

### v1.2.2 - 翻译精准度提升版 (规划中)
**计划发布**: 2025-09-06  
**版本类型**: Patch Release (Translation Quality Enhancement)  
**开发优先级**: 🔴 High  

#### 🎯 版本目标
这是一个专注于提升翻译精准度的重要更新，通过重构Settings页面、开放Prompt定制和添加专业词库功能，让用户能够获得更精确、更符合场景的翻译结果。

#### ✨ 核心功能规划
- [ ] **多标签Settings页面** - 重构设置页面为多子标签形式，提升配置体验
- [ ] **语言和模型设置** - 独立的语言和引擎配置页面，支持默认目标语言设置
- [ ] **Prompt定制系统** - 开放部分Prompt给用户自定义，提升翻译场景匹配度
- [ ] **专业词库管理** - 支持用户自定义专业术语，确保术语翻译的准确性和一致性
- [ ] **翻译历史记录** - 完整的历史翻译记录查看和管理功能

#### 🏗️ Settings页面架构重构
**多子标签设计**:
1. **🌐 语言&模型** - 默认目标语言、引擎配置、API密钥管理
2. **📝 Prompt设置** - 场景描述、专业词库、翻译约束
3. **📚 翻译历史** - 历史记录列表、搜索、导出功能

#### 🌐 语言和模型设置详细功能
- [ ] **默认目标语言设置**: 支持设置默认翻译目标语言(默认：英语)
- [ ] **引擎配置优化**: 保持现有OpenAI/Gemini配置，默认选中Gemini 1.5 Flash
- [ ] **API密钥管理**: 优化密钥输入界面，增加连接状态显示
- [ ] **模型性能说明**: 为每个模型添加速度、质量、成本的说明标签

#### 📝 Prompt定制系统设计
**核心原则**: 在不影响翻译质量的前提下，开放关键定制点

**开放的定制部分**:
1. **📋 场景描述 (Design Context)**
   - 用户可描述当前设计稿的类型、用途、目标用户
   - 帮助AI理解翻译场景，选择更合适的用词风格
   - 可留空，留空时使用默认的通用场景描述
   - 示例：「这是一个电商APP的商品详情页面，面向年轻消费者」

2. **📖 专业词库 (Professional Glossary)**
   - 支持添加专业术语的中英文对照
   - 仅支持中文→英文翻译场景（v1.2.2范围）
   - 格式：「原始词条」→「翻译词条」
   - 自动集成到主Prompt中，确保术语翻译一致性

**Prompt架构设计**:
```
主Prompt (隐藏，用户不可见)
├── 系统指令 (固定)
├── 场景描述 (用户可定制)
├── 专业词库 (用户可管理)
└── 输出格式 (固定)
```

#### 📖 专业词库管理功能
**核心挑战**: 在插件小界面中优雅展示多条目内容

**功能设计**:
- [ ] **词库条目管理**: 支持增加、删除、编辑术语对
- [ ] **快速添加**: 提供常用专业词库模板(如科技、医疗、金融)
- [ ] **条目验证**: 检查词库格式正确性，防止影响翻译效果
- [ ] **条目搜索**: 在词库较多时支持快速搜索定位
- [ ] **批量操作**: 支持批量导入/导出词库文件

**视觉设计方案**:
```
📖 专业词库 (12)
┌─────────────────────────────────┐
│ 用户体验 → User Experience     [编辑][删除] │
│ 人工智能 → Artificial Intelligence [编辑][删除] │
│ 云计算   → Cloud Computing      [编辑][删除] │
│ ... 显示更多 (9) ...                        │
├─────────────────────────────────┤
│ [+ 添加词条] [导入] [导出]                    │
└─────────────────────────────────┘
```

#### 📚 翻译历史记录功能
- [ ] **历史记录列表**: 按时间倒序显示翻译任务
- [ ] **记录详情**: 原文、译文、使用引擎、翻译时间
- [ ] **搜索功能**: 支持按原文或译文内容搜索历史记录
- [ ] **记录管理**: 支持删除单条或批量清理历史记录
- [ ] **快速复用**: 一键复用历史翻译结果

#### 🛠️ 技术实现要点
1. **状态管理升级**
   - 扩展AppState结构，支持新的配置字段
   - 实现Tab切换的状态保持和数据同步

2. **Prompt系统重构**
   - 设计可插拔的Prompt模板系统
   - 实现场景描述和词库的动态注入
   - 确保自定义内容不影响翻译质量

3. **数据持久化**
   - 专业词库的本地存储和同步
   - 翻译历史的存储和管理
   - 用户配置的迁移和备份

4. **UI组件设计**
   - 响应式Tab组件适配插件小界面
   - 词库管理的折叠/展开交互设计
   - 历史记录的虚拟滚动优化(如记录较多)

#### ⚠️ 关键注意事项
1. **翻译质量保障**: 
   - 用户自定义内容留空时，不能导致翻译效果变差
   - 主Prompt的核心逻辑保持稳定和优化
   - 专业词库格式验证，防止格式错误影响翻译

2. **小界面设计挑战**:
   - 多标签页在有限空间内的布局优化
   - 专业词库多条目展示的交互设计
   - 历史记录列表的性能和用户体验平衡

3. **向后兼容性**:
   - 保持与v1.2.1的完全兼容
   - 现有用户配置的平滑迁移
   - 默认设置确保新用户开箱即用

#### 📊 预期效果
- **翻译精准度提升**: 通过场景描述和专业词库，提升翻译的场景匹配度
- **专业术语一致性**: 解决不同批次翻译中专业术语不一致的问题
- **用户定制化**: 满足不同行业用户的个性化翻译需求
- **工作流优化**: 通过历史记录功能提升翻译工作的连续性

### v1.3.0 - 撤销和批量编辑功能增强版 (计划中)
**计划发布**: 2024-10-01  
**版本类型**: Minor Release (New Features)  
**开发优先级**: 🟡 medium  

#### 🎯 规划目标
撤销和批量编辑功能增强版

#### ✨ 计划功能\n- [ ] **一键撤销所有翻译**\n- [ ] **批量编辑相同文本翻译**\n- [ ] **增强的批量操作面板**\n\n#### 🛠️ 技术要求\n- 基于v1.2.0稳定版本开发\n- 保持向后兼容性\n- 新增翻译状态管理系统\n\n#### ⚠️ 注意事项
- 需要谨慎处理JavaScript兼容性问题\n


### v1.3.0 - 撤销增强版 (计划中)
**计划发布**: TBD  
**版本类型**: Minor Release  
**开发优先级**: High  

#### 🎯 规划目标
基于v1.2.0稳定版本，增加用户强需求的撤销和批量编辑功能。

#### ✨ 计划功能
- [ ] **一键撤销所有翻译**: 将所有翻译后的文本恢复到翻译前状态
- [ ] **批量编辑相同文本**: 选择一个原始文本，批量修改所有相同文本的翻译结果
- [ ] **翻译历史管理**: 完整的翻译历史追踪和回滚
- [ ] **增强的批量操作面板**: 统一的批量操作入口

#### 🛠️ 技术要求
- 基于v1.2.0稳定版本开发
- 保持向后兼容性
- 新增翻译状态管理系统
- 实现翻译历史存储和恢复

#### ⚠️ 注意事项
- 需要谨慎处理JavaScript兼容性问题
- 避免使用ES2020+特性（如可选链操作符）
- 重点测试模板字符串的兼容性

### v2.0.0 - 架构升级版 (未来规划)
**计划发布**: 未定  
**版本类型**: Major Release  
**开发优先级**: Medium  

#### 🎯 规划目标
重大架构升级，提升性能和可维护性。

#### ✨ 计划功能
- [ ] UI架构重构
- [ ] 性能优化
- [ ] 新的特性和功能
- [ ] API接口升级

---

## 📈 版本管理流程

### 版本规划流程
1. **需求收集**: 用户反馈和功能需求
2. **版本规划**: 使用 `./tools/plan.sh` 创建版本规划
3. **开发阶段**: 在 `src/` 目录进行开发
4. **版本发布**: 使用 `./tools/release.sh` 发布版本
5. **记录更新**: 自动更新本文档和发布说明

### 版本编号规则
- **MAJOR**: 不兼容的重大更新 (如 1.0.0 → 2.0.0)
- **MINOR**: 向后兼容的新功能 (如 1.0.0 → 1.1.0)
- **PATCH**: 向后兼容的bug修复 (如 1.1.0 → 1.1.1)

### 自动化支持
本文档通过以下工具自动维护：
- `./tools/plan.sh` - 版本规划和需求记录
- `./tools/release.sh` - 版本发布和记录更新
- `./tools/version.sh` - 版本信息管理

---

## 📊 统计信息

### 总体进度
- **已发布版本**: 2 个 (v1.2.0, v1.2.1)
- **开发中版本**: 1 个 (v1.2.2 规划中)
- **计划版本**: 1 个 (v1.3.0)

### 功能完成度
- **核心翻译功能**: ✅ 100%
- **用户体验功能**: ✅ 100% (v1.2.1已完成)
- **翻译精准度**: 🚀 0% (v1.2.2规划中)
- **Settings重构**: 📋 0% (v1.2.2规划中)
- **Prompt定制**: 📝 0% (v1.2.2规划中)
- **专业词库**: 📖 0% (v1.2.2规划中)

---

*本文档由版本管理工具自动维护，最后更新: 2025-09-05*